---
title: "문서 인제스천"
description: "업로드→청킹→임베딩→저장"
---
## 이 문서에서 하는 것
- 검색(Retrieval) 설정을 바꾸면서 품질/지연/비용이 어떻게 달라지는지 확인해.

## RAG 파이프라인(큰 흐름)
1) 인제스천: 업로드 → 파싱 → 청킹
2) 임베딩: 청크 → 벡터
3) 검색: 질의 → 벡터검색 → 후보(top-k)
4) (선택) 재랭킹: 후보 재정렬
5) 생성: 답변 + 출처

## 핵심 변수
- chunk_size / chunk_overlap / max_chunks
- embedding 모델(및 dimension)
- top_k / threshold(유사도 임계값)
- rerank on/off

## 기록할 지표
- retrieved_count / score 분포
- 답변 근거성(정말 관련 청크를 가져왔나?)
- 지연/토큰/비용(컨텍스트가 길어지면 prompt가 커짐)

## 자주 터지는 실수
- top-k 과다(노이즈/비용/지연 증가)
- threshold 과다(필요한 청크를 못 가져옴)
- overlap 과다(중복 컨텍스트로 토큰 낭비)

## 인제스천 단계
1) 파일 업로드(PDF 등)
2) 텍스트 파싱
3) 청킹
4) 임베딩 생성
5) pages/chunks/vectors 저장

## 저장 권장 필드(예시)
- document 메타(name, size, mime, created_at)
- pages(page_no, text)
- chunks(chunk_id, page_range, text, tokens)
- vectors(embedding, model, dimension)

## 트러블슈팅
- 파싱 실패: 포맷/파서 제한/암호화 PDF 등
- 느림: 인제스천을 백그라운드 잡/큐로 분리

## 다음 문서
- /rag/chunking
- /rag/embeddings

